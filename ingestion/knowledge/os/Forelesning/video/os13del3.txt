{'text': ' Tidligere så har vi sett på synkronisering. Vi har hele tiden... Det vil si, aller først så så vi på det å multitasking og parallellisere. Få ting til å gå fort i parallell. Og stort sett så går det veldig fint. Så bare å kjøre på i parallell, så sant det er mulig å parallellisere koden. Så kom jeg til noen tilfeller hvor man må serialisere koden. Hvor det er rett og slett ødeleggende at kode kjører i parallell. Og det er da typisk hvis man har en felles ressurs som to eller flere tråder jobber opp mot. Da kan de ødelegge for hverandre. Så et system må være tread safe. Det betyr at man ikke må ha tråder som ødelegger for hverandre. Og da må man serialisere og synkle. Og vi så foregang på forskjellige typer serialisering. Forskjellige metoder for å gjøre det. Bl.a. Mutex og semaforer, monitorer... Dette er teknologier og egentlig tilbud fra operativsystemet til programmereren for å hjelpe til å serialisere. I prinsippet så er det samme ting de oppnår. Men f.eks. monitorer sånn som vi så på i Java, de er enklere å forholde seg til. Det var én enkel metode som man kunne legge rundt en hel blokk, som den synkroniserte metoden. Så den ville da synkronisere hele systemet på en veldig enkel måte. Å bruke mutexer direkte, og også semaforer, er litt mer komplisert. Så dette er på en måte forskjellige tilbud fra operativstemme til programmerere for å kunne serialisere. Men når man serialiserer på denne måten med mutexer, og tvinger prosesser til å vente på hverandre, så får man et problem med at deadlock kan skje. Og det er tre klare kriterier som må være tilfredsstilt for at deadlock skal oppstå. Så hvis man klarer å unngå alle disse tre kriteriene, så kan man si at ok, da unngår jeg deadlock. Men samtidig så er dette gjerne noe man ønsker å få til i et program. Og da må man kode. Sånn at deadlock ikke oppstår. Men det første kriteriet er at man må ha en eller annen form for mutex. Altså man må ha ressurser som ikke kan deles. Hvis alle ressurser kan deles hele tiden, uten noe problem, så vil ikke deadlock oppstå. Så må man også ha et kriterium at en prosess kan beholde sin ressurs mens den venter på andre. Også at en prosess ikke kan tvinges til å gi opp sin ressurs. Hvis disse kriteriene er oppfylt, så kan deadlock oppstå. Og vi kan få deadlock ved sirkulær venting. Vi skal se hva det betyr. Ja... Her er et enkelt eksempel på deadlock. Hvor... Generelt så kan man få deadlock hvis to eller flere prosesser venter på hverandre. Og i det eksempelet her så ser vi at vi kjører prosess A og prosess B. Og de gjør sånn de skal vente S1 for å vente på en ressurs, og signal S1 her nede for å avgi den ressursen. Hvis både Prosess A og Prosess B ønsker å få tak i ressurs S1 og S2... Og Prosess A sånn tilfeldigvis så gjør Prosess A først en wait på S1... Mens Prosess B gjør wait på S2. Og så, mens den venter på S1, så ønsker den også å vente på S2. Den vil også ha den ressursen. Og samtidig gjør... Og da vil vi få en låst situasjon. Da vil vi få en låst situasjon hvor prosess A venter på at prosess B skal release S2, for den har fått tak i SO. Den har nøkkelen her til SO. Og tilsvarende venter Prosess B på at Prosess A skal release essay. Kanskje de står her med en sånn... Med busy waiting. Står og spinner og venter og venter. Og dette kalte seg en deadlock. Den vil aldri løse seg opp. Eksempel én er jo kanskje enklere. Prosess 1 venter på P2. P2 venter på P3, og P3 venter på P1. De bare venter på hverandre. Det kan være en sånn semafor som dette her, men det kunne også være sånn som vi så på forrige gang, at prosess 2 skal være ferdig med noe i koden før prosess 3 går videre osv. Og dette er sånt som kan oppstå i den virkelige verden også. Jeg husker veldig godt at jeg var ute og kjørte bil, og så kom jeg i et kryss hvor man har vikeplikt fra høyre. Og da hadde jeg tidligere snakket om dette på forelesning, at jo, hvis kommer det et kryss med fire biler som skal inn, og det var vanlig virkeplikt, så... Og da var det sånn at jeg ventet på den som sto ved siden av fra høyre. Den ventet på den som sto ved siden av fra høyre igjen, osv. Rundt hele krysset. Så alle sto og ventet på hverandre. Og jeg var den eneste, kanskje av bilistene, som jublet... Yes! Deadlock! De andre tenkte kanskje ikke så nøye over det, men akkurat denne situasjonen er det som skjer i programmer. Hvor de venter på hverandre, og så kan en deadlock-situasjon som det oppstå...', 'chunks': [{'timestamp': (0.0, 7.68), 'text': ' Tidligere så har vi sett på synkronisering.'}, {'timestamp': (7.68, 10.52), 'text': ' Vi har hele tiden...'}, {'timestamp': (10.52, 17.2), 'text': ' Det vil si, aller først så så vi på det å multitasking og parallellisere.'}, {'timestamp': (17.2, 21.18), 'text': ' Få ting til å gå fort i parallell.'}, {'timestamp': (21.18, 25.88), 'text': ' Og stort sett så går det veldig fint. Så bare å kjøre på i parallell,'}, {'timestamp': (25.88, 29.8), 'text': ' så sant det er mulig å parallellisere koden.'}, {'timestamp': (30.0, 33.84), 'text': ' Så kom jeg til noen tilfeller hvor man må serialisere koden.'}, {'timestamp': (33.84, 39.22), 'text': ' Hvor det er rett og slett ødeleggende at kode kjører i parallell.'}, {'timestamp': (39.22, 43.08), 'text': ' Og det er da typisk hvis man har en felles ressurs'}, {'timestamp': (44.0, 47.4), 'text': ' som to eller flere tråder jobber opp mot.'}, {'timestamp': (47.4, 52.48), 'text': ' Da kan de ødelegge for hverandre. Så et system må være tread safe.'}, {'timestamp': (52.56, 56.76), 'text': ' Det betyr at man ikke må ha tråder som ødelegger for hverandre.'}, {'timestamp': (56.76, 59.96), 'text': ' Og da må man serialisere og synkle.'}, {'timestamp': (60.0, 67.08), 'text': ' Og vi så foregang på forskjellige typer serialisering.'}, {'timestamp': (67.16, 74.2), 'text': ' Forskjellige metoder for å gjøre det. Bl.a. Mutex og semaforer, monitorer...'}, {'timestamp': (74.2, 83.56), 'text': ' Dette er teknologier og egentlig tilbud fra operativsystemet til programmereren'}, {'timestamp': (83.56, 87.44), 'text': ' for å hjelpe til å serialisere.'}, {'timestamp': (90.02, 94.0), 'text': ' I prinsippet så er det samme ting de oppnår.'}, {'timestamp': (94.02, 99.18), 'text': ' Men f.eks. monitorer sånn som vi så på i Java,'}, {'timestamp': (99.26, 103.9), 'text': ' de er enklere å forholde seg til.'}, {'timestamp': (103.98, 110.78), 'text': ' Det var én enkel metode som man kunne legge rundt en hel blokk,'}, {'timestamp': (110.86, 114.1), 'text': ' som den synkroniserte metoden.'}, {'timestamp': (114.18, 118.54), 'text': ' Så den ville da synkronisere hele systemet på en veldig enkel måte.'}, {'timestamp': (120.0, 125.28), 'text': ' Å bruke mutexer direkte, og også semaforer, er litt mer komplisert.'}, {'timestamp': (126.48, 130.64), 'text': ' Så dette er på en måte forskjellige tilbud fra operativstemme til programmerere'}, {'timestamp': (130.64, 132.84), 'text': ' for å kunne serialisere.'}, {'timestamp': (132.84, 140.68), 'text': ' Men når man serialiserer på denne måten med mutexer,'}, {'timestamp': (141.72, 145.52), 'text': ' og tvinger prosesser til å vente på hverandre,'}, {'timestamp': (146.32, 149.12), 'text': ' så får man et problem med at deadlock kan skje.'}, {'timestamp': (150.0, 159.0), 'text': ' Og det er tre klare kriterier som må være tilfredsstilt'}, {'timestamp': (159.12, 162.28), 'text': ' for at deadlock skal oppstå.'}, {'timestamp': (162.28, 168.0), 'text': ' Så hvis man klarer å unngå alle disse tre kriteriene, så kan man si'}, {'timestamp': (168.12, 173.08), 'text': ' at ok, da unngår jeg deadlock. Men samtidig så er dette gjerne noe'}, {'timestamp': (173.58, 179.16), 'text': ' man ønsker å få til i et program. Og da må man kode.'}, {'timestamp': (180.0, 182.98), 'text': ' Sånn at deadlock ikke oppstår.'}, {'timestamp': (183.0, 188.8), 'text': ' Men det første kriteriet er at man må ha en eller annen form for mutex.'}, {'timestamp': (188.88, 193.2), 'text': ' Altså man må ha ressurser som ikke kan deles.'}, {'timestamp': (194.68, 197.72), 'text': ' Hvis alle ressurser kan deles hele tiden,'}, {'timestamp': (197.8, 201.96), 'text': ' uten noe problem, så vil ikke deadlock oppstå.'}, {'timestamp': (201.96, 206.0), 'text': ' Så må man også ha et kriterium at en prosess kan beholde sin ressurs'}, {'timestamp': (206.08, 209.0), 'text': ' mens den venter på andre.'}, {'timestamp': (210.02, 215.06), 'text': ' Også at en prosess ikke kan tvinges til å gi opp sin ressurs.'}, {'timestamp': (215.06, 223.42), 'text': ' Hvis disse kriteriene er oppfylt, så kan deadlock oppstå.'}, {'timestamp': (223.42, 227.9), 'text': ' Og vi kan få deadlock ved sirkulær venting.'}, {'timestamp': (227.98, 231.8), 'text': ' Vi skal se hva det betyr.'}, {'timestamp': (231.8, 239.8), 'text': ' Ja... Her er et enkelt eksempel på deadlock.'}, {'timestamp': (240.0, 245.16), 'text': ' Hvor... Generelt så kan man få deadlock'}, {'timestamp': (245.24, 249.24), 'text': ' hvis to eller flere prosesser venter på hverandre.'}, {'timestamp': (249.24, 255.16), 'text': ' Og i det eksempelet her så ser vi at vi kjører prosess A og prosess B.'}, {'timestamp': (255.16, 262.44), 'text': ' Og de gjør sånn de skal vente S1 for å vente på en ressurs,'}, {'timestamp': (262.52, 266.56), 'text': ' og signal S1 her nede for å avgi den ressursen.'}, {'timestamp': (270.0, 278.0), 'text': ' Hvis både Prosess A og Prosess B ønsker å få tak i ressurs S1 og S2...'}, {'timestamp': (278.0, 285.0), 'text': ' Og Prosess A sånn tilfeldigvis så gjør Prosess A først en wait på S1...'}, {'timestamp': (285.0, 290.32), 'text': ' Mens Prosess B gjør wait på S2.'}, {'timestamp': (290.38, 296.2), 'text': ' Og så, mens den venter på S1, så ønsker den også å vente på S2.'}, {'timestamp': (296.28, 299.98), 'text': ' Den vil også ha den ressursen. Og samtidig gjør...'}, {'timestamp': (300.0, 310.32), 'text': ' Og da vil vi få en låst situasjon.'}, {'timestamp': (310.32, 319.24), 'text': ' Da vil vi få en låst situasjon hvor prosess A venter på'}, {'timestamp': (319.32, 327.56), 'text': ' at prosess B skal release S2, for den har fått tak i SO.'}, {'timestamp': (327.64, 329.72), 'text': ' Den har nøkkelen her til SO.'}, {'timestamp': (330.0, 335.62), 'text': ' Og tilsvarende venter Prosess B på at Prosess A skal release essay.'}, {'timestamp': (335.64, 339.52), 'text': ' Kanskje de står her med en sånn...'}, {'timestamp': (340.08, 344.56), 'text': ' Med busy waiting. Står og spinner og venter og venter.'}, {'timestamp': (344.64, 348.96), 'text': ' Og dette kalte seg en deadlock. Den vil aldri løse seg opp.'}, {'timestamp': (349.98, 354.36), 'text': ' Eksempel én er jo kanskje enklere. Prosess 1 venter på P2.'}, {'timestamp': (354.44, 358.48), 'text': ' P2 venter på P3, og P3 venter på P1. De bare venter på hverandre.'}, {'timestamp': (360.0, 363.2), 'text': ' Det kan være en sånn semafor som dette her,'}, {'timestamp': (363.28, 367.0), 'text': ' men det kunne også være sånn som vi så på forrige gang,'}, {'timestamp': (367.12, 371.24), 'text': ' at prosess 2 skal være ferdig med noe i koden før prosess 3 går videre osv.'}, {'timestamp': (371.24, 378.2), 'text': ' Og dette er sånt som kan oppstå i den virkelige verden også.'}, {'timestamp': (378.56, 383.68), 'text': ' Jeg husker veldig godt at jeg var ute og kjørte bil,'}, {'timestamp': (383.8, 389.84), 'text': ' og så kom jeg i et kryss hvor man har vikeplikt fra høyre.'}, {'timestamp': (390.0, 393.76), 'text': ' Og da hadde jeg tidligere snakket om dette på forelesning,'}, {'timestamp': (394.8, 397.8), 'text': ' at jo, hvis kommer det et kryss med fire biler som skal inn,'}, {'timestamp': (398.4, 400.16), 'text': ' og det var vanlig virkeplikt, så...'}, {'timestamp': (400.18, 404.4), 'text': ' Og da var det sånn at jeg ventet på den som sto ved siden av fra høyre.'}, {'timestamp': (404.4, 408.64), 'text': ' Den ventet på den som sto ved siden av fra høyre igjen, osv.'}, {'timestamp': (408.72, 412.44), 'text': ' Rundt hele krysset. Så alle sto og ventet på hverandre.'}, {'timestamp': (412.44, 419.76), 'text': ' Og jeg var den eneste, kanskje av bilistene, som jublet... Yes! Deadlock!'}, {'timestamp': (420.0, 423.6), 'text': ' De andre tenkte kanskje ikke så nøye over det,'}, {'timestamp': (423.68, 428.4), 'text': ' men akkurat denne situasjonen er det som skjer i programmer.'}, {'timestamp': (428.4, 435.6), 'text': ' Hvor de venter på hverandre, og så kan en deadlock-situasjon som det oppstå...'}]}
{'text': " Oppgavene denne uken... er ikke sånn veldig mange. Vi tar det litt forsiktig denne uken. Vi har kommet ganske langt i pensum, sånn at vi har råd til å ta det litt rolig nå før påske. Så det er ikke sånn veldig mange obligatoriske oppgaver. Noen litt teoretiske, og det er mer... Det kan være veldig nyttig å gjøre de også, sånn at du tenker igjennom hva det egentlig er vi holder på med. Disse kan man da også se løsningsforslag på. Men jeg anbefaler veldig ikke å gå rett på løsningsforslaget når du jobber med de oppgavene her. Prøv å komme opp med svar, og så sammenlign med løsningsforslaget. Det er absolutt å anbefale. Og så er det noen oppgaver etter hvert om det vi skal se på nå. I forelesningen prioritering Java og kjøring av Java-tråder. Og ikke minst så kommer det etter hvert en oppgave her med Java-tråder og synkronisering. Og vi skal se hvor viktig det er å synkronisere når du har en felles variabel. Men det er det som egentlig er hovedtemaet i dag. Spørsmål? Et par ukens nøtter. Ja. Om eksamen blir med karakter eller ikke, vet du om det er avklart ennå? Ja, kjempebra. Det har jeg fått avklaring på nå, at det blir med ATLF-karakterer. Så bra. Jeg kan legge ut en kunngjøring om det etterpå også, kanskje. Så alle får det med seg. Jeg bare glemte det. Så kjempefint. Det kommer et par dokkeroppgaver. Det er litt endring på planen her. Vi syns det passer fint å starte med Windows PowerShell etter påske. Så blir det i hvert fall to runder med PowerShell digitalt. Så kommer det litt om dokker og DokkerHub denne uken. Det blir en sånn påskespesial med bare litt innhold. En kvarter-halvtime innhold, så ikke så veldig mye. Og oppgaver til dette vil da komme etter påske. Men uansett, jeg kan prøve å kanskje få lagt ut dette om Windows og Poshell og oppgaver, sånn at de som ønsker å ligge litt foran, vi kan jobbe. Og har lyst til å jobbe litt i påsken. De kan jobbe med jobb med det. Ok, andre spørsmål eller karakterer... Nei, eller karakterer! Kommentarer! Jeg har ikke fått noen hos meg, i hvert fall. Nei. Ok... Ja, oi... Og jeg hadde helt glemt å si at det er veldig hyggelig å se så mange av dere. Det er kjempebra. Vi har 75 stykker i chatten her nå. Veldig godt at dere står opp og jobber videre. Jeg skjønner at det kan være veldig tungt for mange av dere som sitter alene og jobber og ikke får besøke venner osv. Og ikke minst det jeg tror dere savner, er å kunne sitte sammen med andre studenter og samarbeide. Prøv gjerne, spesielt hvis dere jobber i gruppe, å få til litt jevnlig kontakt. Lag SOM-møter osv. Bruk screen når dere jobber med kommandolinje. Det er mulig å få til å samarbeide, også om dere sitter på hvert deres sett. Så prøv mest mulig å få til det. Hvor mange forsøk har vi på MC2? Dere har flere forsøk. I praksis så kan dere få... Ikke uvennlige forsøk, men dere kan få mange forsøk. Men... Og det er også derfor vi har lagt opp opplegget, sånn at man ikke bare kan få nye og nye forsøk hele tiden. For da er det mange som bare klikker i vei. Så tanken er at hvis du ikke får det til første gang, Så må du ta kontakt med en studentassistent, ikke minst... eller meg. Og så må du få diskutere... Finn ut hva det var du gjorde feil. Og kanskje hva må du jobbe litt mer med før du tar et nytt forsøk. Så jobb skikkelig med den responsen du får først, og så tar du et nytt forsøk. Men dette er ikke noen sånn straffedom. Det er først og fremst ment som et tilbud. Altså at dere skal få tilbakemeldinger på... Det er også viktig at MC2 er nok litt vanskeligere enn MC1. Og du kan også være litt uheldig. Det trekkes fra 30 spørsmål kanskje. Så du kan være litt uheldig og få noen som er spesielt vanskelig, som ikke er så lett å ta på ett minutt. Men fristen er, som det står her... Det blir vel litt vanskelig. 9. april, som er fristen for MC2. Så prøv absolutt å få gjort den denne uken, sånn at du får flere sjanser. Hvis dere ikke klarer den. Ok... Forrige gang så så vi på Plattformaget, aller først. Hva som skjedde når man flytter programmet rundt på plattformer. Hovedkonklusjonen er at programmer som er kopilert, sånn som C og C++, som kopieres til maskinkode, er helt plattformavhengig. Det betyr at de kan bare kjøre der på den plattformen de er kopilert. De fleste moderne språk, sånn som... Java og Python, CSharp også, de kjører virtuelle maskiner. Sånn at da komplerer man til en eller annen type bytekode. Og så kjøres det i en virtuell maskin. Det betyr at det er en virtuell maskin for hver plattform. Så da går det an i prinsippet å flytte kompliert kode fra en plattform til en annen. Men det kan ha litt avhengighet av versjoner, som vi så sist. Så begynte vi å se på tråder. Vi så litt teoretisk på tråder, men vi fikk ikke sett så veldig mye på det rent praktisk. Så vi skal ta en kjapp rekapitulering av Java-tråder, og så se på spesielt mange samtidige tråder. Så vi kan starte med det. Det var eksempelet. Trådprogram implementert i Java, som implementerer en rekke tråder... Jeg tror jeg kjører noe sånt som 20 tråder i det eksempelet her. Det var noen oppgaver i forrige uke som gikk ut på at man skulle se på hvor mange tråder som kjøres av operativsystemet når man kjører to tråder. Og da var det overraskende nok veldig mange tråder. Borti 20 tråder. Og det var en masse sånne workertreads som operativsystemet setter opp. Oi! Eller som JVM starter opp, og som operativsystemet skredulerer. Så det er hjelpetråder som står klare til å gjøre alle slags forskjellige oppgaver. Det koster ikke så mye å ha disse ekstra trådene, så derfor er det veldig mange programmer, sånn som Java... Chrome og andre applikasjoner som kjører en rekke tråder. Det koster ganske lite for operativseiere å ha de trådene kjørende når de ikke bruker CPU. Men her er da et eksempel på... Et eksempel som kjører med mange tråder. Så vi kan gå ned til klassen Calcmanny her, som er main. Og det som skjer her, er at vi definerer en intreds som er 20. Så det vi skal gjøre, er å starte 20 uavhengige tråder. Og her så kalles... Er opprettet et nytt trådobjekt, med new. Så her opprettes en ny tråd. Og så skriver jeg bare ut at vi starter... At vi starter 20.30. Og så går jeg inn i forløkket. Ja, og her starter jeg da tråd nummer null. A new caltred. Og så når collegue 1, så starter jeg tråd nummer 1, osv. Så bare skriver jeg ut at jeg starter tråd nummer 1. Og så kaller jeg på startmetoden for tråden. Så dette skjer da 20 ganger. Og hvis vi går opp her, så ser vi hva som skjer når calc3d kalles. Da... Når calc3d startes opp, så kjøres denne in-hit-metoden her. Count pluss pluss... Da er det viktig å huske at... Count er definert som static. Og det betyr at det finnes bare én av den for alle trådene. Vi har 20 tråder, men bare én enkelt count-variabel. Mens en variabel som ikke blir deklarert som static, sånn som int id... Den har vi da 20 stykker av. Når vi har en maks her, så kunne også den vært static. For den skal være den samme for alle. Men her lager vi også 20 maks. Men det viktigste her er konto ID. Så hver gang vi øker konto, så økes den felles variabelen. Og dermed så teller den opp fra 1 og opp til 20. Og så setter ID en leak count, så da får vi en ID på hver. Og så sier jeg 3d nummer først 1 i starting... Så 3d nummer 1 Calculated Work. Og her ser vi at den tråden gjør et arbeid. Men det som skjer inneni work, er at 15 ganger så regner det ut en kjempelang løkke. Java er såpass rask at selv om man står og regner sånn som dette her, så kan man gjøre det... Hvor mange ganger kjører vi det her? 900 millioner ganger. Det er så mange ganger... Så blir det høyere enn en int. Så da får man trøbbel. Så dette er ekstremt mange ganger den går, men likevel så regner det mange ganger. Og det som er hovedpoenget her nå, med tråder, er at når vi setter i gang de, så kjører de samtidig. Så vi kan... Vi kan kompilere. Og så kjører vi her, kanskje. I sidevinduet, så vi kan se på trådene mens vi kjører. Jeg ser det starter veldig kjapt, så startes det opp 20 tråder. Så kan vi se på det i topp. I utgangspunktet så ser vi at det er én prosess som kjører. Men hvis vi legger på... Hvis vi velger ut 'number of threads', så ser vi at den ene prosessen som kjører, den har 37 tråder. Vi ser også at faktisk de fleste andre prosesser også har en rekke tråder. Sånn som Zoom har 64 tråder. Ops, har 27. Men det som er spesielt med våre tråder nå, er at 20 av de er de regnetrådene som vi har startet. Så kan vi også, hvis vi taster H, så får vi se alle trådene. Og da ser vi at det er 20 tråder som står og kjører. Så kunne vi også ta og se på Last Use CPU. Hvis jeg velger den... Så ser vi da at trådene er skredulert på forskjellige CPU-er. Noen er da så klart på mange, for her er det bare 0 til 7 av CPU-er. Men vi ser da hvordan det er operativsystemet som skredulerer alle trådene. Java bare setter i gang en masse tråder, og så blir det skredulert av OS. Og akkurat det samme er det med alle de andre programmene. De starter en rekke tråder, men de blir skredulert som helt uavhengige enheter. Ok... Da skal vi se på et annet eksempel. Og prioritet i Java er... Det vi skal se, er at prioritet er litt merkelig implementert, på en måte, i Java. Det er implementert forskjellig i Linux og i Windows, f.eks. Men i dette eksempelet skal vi se at det faktisk ikke er det. Men før vi diskuterer det, så kan vi se på... Skal vi se... Jeg har et Java-program som heter Prior.java. Dette programmet implementerer da prioritet. Det ligner ganske på de andre programmene vi har sett på. I dette tilfellet så startes det to tråder. Prioritredd én som jeg kaller S1, og én som jeg kaller S2. Jeg kaller det prioritredd fordi jeg bruker prioritering. Og så setter jeg prioriteten til S1 til 5. Det er faktisk default-prioritet, så hvis jeg ikke hadde gjort det, så ville den likevel vært 5. Og så er det noen variabler. SN Norm Priority. Jeg skriver ut den for å få frem hva som er normal prioritet, eller standard. Og så skriver jeg ut maks prioritet og min prioritet. Maksprioritet er ti, hvis jeg husker riktig, og min er én. Så dette er motsatt av nice, for nice er jo hvor snill man er med andre. Så det er ti prioritetsklasser. Ja, min er null. Vi starter på null, og så er maks ti. Så... Nei... Sorry, glem det jeg sa. Dette er ikke prioriteten. Det som jeg sender med der, er antall millisekunder som tråden skal sove før den starter. Vi ser begge starter med en gang. Men jeg setter prioriteten for tråd nummer to. Den setter jeg til 10. Så vi starter én tråd med prioritet 5 og én med prioritet 10. 10 er det aller høyeste, så da burde man forvente at et eller annet... Det skjer sånn at tråd nummer to kjører mer. Vi har jo bedt om at den skal få høyere prioritet. Vi kan se kjapt øverst her hva vi gjør. Det vi gjør, ligner veldig på det vi gjorde tidligere. Vi har en tellecount og en ID, så de får ID 1 og 2. Og så i tillegg så er det millisekunder. Det skal vi bruke på Windows etterpå når vi skal kjøre det der. Gi tråden noen millisekunder før den starter. Men vi gir den null millisekunder her, sånn at det er lettere å se hva som skjer i vårt tilfelle. Så vi kan jo også se hvordan vi behandler to forskjellige tråder. For de kjører i utgangspunktet samme kode, men så ser vi... Her er Rønn-metoden, som sier tråd nummer én sover først, null millisekunder, og så starter den. Men så ser vi... Her har jeg en if-test hvor jeg da tester hvis Ida er lik to, så setter jeg prioritet til én. Så på den måten kan man da behandle tråder og gjøre forskjellige ting, selv om trådene i utgangspunktet er like. Så vi kan se... Hvordan dette ser ut når vi kompilerer og...... kjører denne tråden. Så da ser vi. Vi starter default prioritet fem. Vi starter nummer én med prioritet fem. Og så starter nummer to med prioritet... ti. De kjører annenhver gang. Det går akkurat like fort med nr. 1 som med nr. 2. Så går vi ned her og setter prioriteten for tråd nr. 2. Den setter vi til 1, så da burde den ha minst prioritet. 1 er da det minste. Men likevel så ser vi at disse to jobber akkurat like fort. Hvis vi prøver å se på topp når de jobber, så... Så får begge 100 % CPU. Vi har ikke noe nice eller noe sånt der. Men vi har jo også sett tidligere at hvis man har nice-prosesser, så... Så vil de ikke være nice i forhold til hverandre. Det jeg kunne prøve å gjøre, var å starte trådene med TaskSet. Det har jeg faktisk ikke tenkt på tidligere, men vi kan gjøre et forsøk. Hvis jeg nå ser på Last Use TPU... Og så kan jeg prøve å starte Java med TaskSet minus 1.0. Sånn. Og så H. Da ser vi begge trådene kjører på tråd 0. Men vi ser at de deler helt broderlig. Selv om den ene tråden nå har prioritet 5. Og den andre har prioritert 10. Så tråd nr. 2 har prioritert 10, men dette gir ikke utslag på hvor mye CPU de får. Og vi kan ikke annet enn konkludere med at Linux faktisk ikke bryr seg om den prioriteten. Om du setter prioritet 1 eller 10, spiller ingen rolle. Men vi overlater til oppgavene. I oppgavene denne uken så blir dere bedt om å... Prøve å få Linux til å ta hensyn til Java-prioriteten. Og det er mulig hvis du kjører Java på en spesiell måte med et spesielt flagg. Men det virker ikke da hvis du kjører som vanlig bruker. Du må faktisk kjøre som Ruth, og i tillegg må du ha et spesielt flagg. Implementerer JVM dette her med NICE? At man setter NICE på Java-trådene, sånn at de har prioritet i forhold til hverandre. For å se dette eksplisitt, så må du gjøre sånn som jeg gjorde nå, og bruke tastet ditt, sånn at de eksplisitt kjører på samme CPU. Hvis ikke, så ser du ikke effekten, med mindre du har veldig mange... Har veldig mange tråder. Flere tråder enn Sepur. Ok. Da tenkte jeg å... Ja, jeg tenkte egentlig også å kjøre trådene på... Kjøre trådene på Windows. Men skal vi se... Ja, det tar litt tid å sette opp de Windows-trådene. Hvis vi gjør det etter pausen, så kan vi heller se på... Nå gå til litt flere slides om tråder. Så vi skal se litt mer teoretisk på tråder. Og aller først skal vi se på blokkerende systemkall. Men før vi avslutter demoen her... Vi skal se etter pause at hvis vi gjør dette samme på Windows... kjører det samme programmet, så vil vi se at Windows faktisk tar hensyn til prioriteten. Og den tar kraftig hensyn. Så hvis du er i tråd med prioritet 4, så får den mye lavere prioritet enn en tråd med prioritet 5. Mens Linux da ikke tar hensyn i det hele tatt. Ok... At man ønsker å lese noe fra en disk. Og da er det jo naturlig at programmet ikke går videre før den har lest det som den har på disken. Og i alle denne type systemkall hvor man må vente på resultatet før programmet kan gå videre, det er da representert ved et blokkerende systemkall. For da gjør man et systemkall, og så blokkerer det prosessen. Og det kan være veldig uheldig. For du ønsker gjerne at en applikasjon skal være responsiv, selv om den leser noe fra disk eller gjør noe annet som krever IO. Og derfor så... Det var på en måte en av hovedideene for å få inn tråder. Nemlig at programmereren kan da... Ved hjelp av IO... Programmet trenger da ikke å vente på blokkerende systemkall. Noen eksempler på den type systemkall er sånn som read and write, await og opplagt når du venter på andre til to år, og sleep er også opplagt blokkerende, for der venter du eksplisitt. Det mest typiske er sånn som read, hvor du leser noe fra disk, Og vente på å få resultatet før du kan kjøre videre. Så fins en del ikke-blokkerende systemkall også, eller veldig mange, sånn som GetPayDay og GetTimeOfDay f.eks. De eksekverer ferdig veldig raskt, og de blokkerer da ikke prosessen. Trådmodeller. Det finnes mange implementasjoner av tråder, og dette er de tre vanligste og mest brukte trådmodellene. Og den som er aller vanligst med en gang, det er én til én. Det er denne modellen her, hvor for hver tråd brukeren starter, f.eks. vi starter et Java-program, JVM starter 20 tråder... Tilsvarende være 20 kjernetråder. Det betyr i praksis at du har 20 tråder som skreduleres som 20 uavhengige enheter. 20 uavhengige regneoperasjoner. I tillegg så har vi én til mange. Vi kan se litt på neste slide hvor disse blir beskrevet. Én til mange, det... Betyr at alle trådene skeduleres som én prosess. Det er ikke så veldig vanlig lenger. Tidligere fantes en del sånne implementasjoner. Det kalles ofte green threats. Den aller første implementasjonen på Linux av JVM var til green threats. Men det er jo litt upraktisk, for det som skjer da, er at programmeren selv må skedulere. Vi har f.eks. en metode som kalles yield, som sier OK, nå vil jeg gi fra meg SFP-en. Og GIL er en sånn... Er ikke så mye i bruk når man overlater til operativsystemet å skredulere. Men dette er da den trådmodellen. Så har vi 1-1, som er den mest vanlige, hvor alle tråder skreduleres uavhengig av hverandre av operativsystemet. Det er det som vi har i Java, og etter pausen skal vi se på noe Post-X-Treads. De skreduleres også på denne måten. Så har man en tredje måte, mange-til-mange. Og da skreduleres de som én-til-én, hvis det ikke er altfor mange tråder. Men så har det vært en del operativsystemer som har man implementert mange-til-mange for tilfeller hvor det er ekstremt mange tråder. Altså mange hundre eller mange tusen tråder. Kan det være uheldig at alle disse trådene skreduleres hver for seg? Så lager man grupper, sånn at én kjernetråd tar hånd om et sett av tråder. Når det er snakk om mange, kan det være 50 tråder som skreduleres av denne, og 50 av denne tråden. Da får de en intern skredulering seg imellom. Synkronisering. Ja, da er vi over på et helt nytt tema, men som ligger tett opp til dette med tråder og problemer man kan få når man kjører tråder samtidig. Kommunikasjon og kommunikasjon er generelt viktig når man har felles ressurser eller felles data som flere prosesser samtidig behandler. Og dette kommer til å være tema resten av dagen. Vi skal se på noen konkrete eksempler på hva som kan gå galt hvis prosesser prøver å endre på felles data samtidig. Da kan det bli en skikkelig krasj. Og de prinsippene vi følger, er at prosesser må ikke endre felles data samtidig. Vi har et eksempel med et billettsystem. Og hvis den ene prosessen da tar en billett og oppdaterer... Og deler ut den billetten samtidig som en annen gjør det samme... Da kan vi få problemer. Det er en såkalt race condition. Det har noe å si hvem som kommer først frem. Databasen kan ødelegges. Den variabelen kan få en feil verdi hvis man ikke synkroniserer. Det er derfor synkronisering er så viktig. Og dette er altså noe som praktisk dukker opp med en gang man har prosesser som jobber mot noe felles. Og det er veldig vanlig. Nå som man har masse distribuerte systemer som kobler seg opp mot samme database, så er det veldig viktig å synkronisere disse tilgangene til data. Et andre prinsipp vi har, er at en prosess ikke bør lese fellesdata mens en annen endrer dem. Den må også kunne vente på resultater fra en annen prosess. Det er en annen måte å synkronisere på, som vi skal se på senere. Da må prosessene seg imellom synkroniseres. Serialisering er det temaet vi først og fremst skal se på i dag. Da ser vi på prosesser eller tråder som aksesserer felles data. Det kan være bare én enkelt variabel. Men det som er viktig, er at de har felles. Med jawatråder vil det være en static... Når vi definerer en variabel som static, så er den felles. Vi skal se noen eksempler med at dette er en saldo. Det er opplagt at når man gjør endringer på saldo, så må det gjøres systematisk. Og da må én av gangen jobbe på de dataene. Problemet er typisk at man leser av en saldo. Det kan være fra en database, men det kan også være fra en felles variable ramm. Men som vi har sett tidligere, når SEP 1 skal regne på det, så vil den verdien lastes inn i registrene. Og der kan det fort bli krøll hvis to prosesser ikke er synkronisert, eller serialisert, når de gjør dette. Det vi selv realiserer, er at vi sier at én av gangen får tilgang til denne fellesvarerabelen. Hele denne problemsiden kalles 'of the race condition', altså konkurranse om en felles ressurs. Den race condition vil da være sånn at utfallet av å kjøre programmene er forskjellig avhengig av hvilken prosess som kommer først fram til den felles ressursen. Og sånn kan det absolutt ikke være. Alt programmet bør være sånn at... Hvis du kjører de med akkurat samme randbetingelser, akkurat samme forutsetninger, så bør resultatet bli det samme. Men det skal vi se. Hvis man ikke serialiserer, så skal vi se flere eksempler på at da går det virkelig galt, og data ødelegges. Så er det også et viktig poeng at det er programmereren selv som må serialisere prosesser. Men som vi skal se, operativsystemet legger til rette for det. Muligheter som programmereren har for å selvrealisere. Ja, men da tar vi en pause der. Men jeg skal bare først ta... Det var et interessant spørsmål i chatten her. Hvis det ikke har så mye å si hvordan prosessene kjøres... Jeg antar tanken her da... Sånn som Java. Java på Linux, hvis den ikke tar hensyn til prioriteten... Vel, det... Vanligvis så har alle tråder samme prioritet. Og det fungerer i de aller fleste tilfeller helt greit. Fordi operativsystemet er så bra. De fordeler ressurser, og operativstemme er veldig bra til å gi respons til prosesser som ønskerespons fra et tastetrykk f.eks. Så får den lynraskt den responsen. Hovedgrunnen til at man ikke har tatt så nøye på implementering av prioritet, som i Java, er at operativstemme gjør den jobben veldig bra. Likevel mange fordeler. En av de største er at prosessen slipper å vente. Du kan ha en tråd som står og venter på input og oppputt, og ikke minst så kan du utnytte flere CPU-er. Hvis du har en server med 48 CPU-er, så er det helt strålende å kunne sette i gang 48 tråder som jobber i parallell på dem og utnytter ressursene. Ja, OK. Men da tar vi en pause der. Og så tar vi et kvarters pause til... hva blir det? 9.35 kan vi ta en pause.", 'chunks': [{'timestamp': (0.0, 10.34), 'text': ' Oppgavene denne uken... er ikke sånn veldig mange.'}, {'timestamp': (10.36, 14.84), 'text': ' Vi tar det litt forsiktig denne uken.'}, {'timestamp': (14.84, 23.48), 'text': ' Vi har kommet ganske langt i pensum, sånn at vi har råd til å ta det litt rolig nå før påske.'}, {'timestamp': (23.48, 28.48), 'text': ' Så det er ikke sånn veldig mange obligatoriske oppgaver.'}, {'timestamp': (30.0, 34.86), 'text': ' Noen litt teoretiske, og det er mer...'}, {'timestamp': (34.86, 38.4), 'text': ' Det kan være veldig nyttig å gjøre de også, sånn at du tenker igjennom'}, {'timestamp': (38.48, 41.24), 'text': ' hva det egentlig er vi holder på med.'}, {'timestamp': (41.32, 44.4), 'text': ' Disse kan man da også se løsningsforslag på.'}, {'timestamp': (44.48, 47.56), 'text': ' Men jeg anbefaler veldig ikke å gå rett på løsningsforslaget'}, {'timestamp': (47.64, 49.8), 'text': ' når du jobber med de oppgavene her.'}, {'timestamp': (49.88, 52.8), 'text': ' Prøv å komme opp med svar, og så sammenlign med løsningsforslaget.'}, {'timestamp': (52.8, 54.6), 'text': ' Det er absolutt å anbefale.'}, {'timestamp': (54.78, 59.86), 'text': ' Og så er det noen oppgaver etter hvert om det vi skal se på nå.'}, {'timestamp': (60.0, 65.06), 'text': ' I forelesningen prioritering Java og kjøring av Java-tråder.'}, {'timestamp': (65.06, 71.08), 'text': ' Og ikke minst så kommer det etter hvert en oppgave her'}, {'timestamp': (71.08, 74.08), 'text': ' med Java-tråder og synkronisering.'}, {'timestamp': (74.26, 79.22), 'text': ' Og vi skal se hvor viktig det er å synkronisere når du har'}, {'timestamp': (79.3, 84.06), 'text': ' en felles variabel. Men det er det som egentlig er hovedtemaet i dag.'}, {'timestamp': (84.06, 87.18), 'text': ' Spørsmål? Et par ukens nøtter. Ja.'}, {'timestamp': (90.0, 95.84), 'text': ' Om eksamen blir med karakter eller ikke, vet du om det er avklart ennå?'}, {'timestamp': (95.92, 102.68), 'text': ' Ja, kjempebra. Det har jeg fått avklaring på nå, at det blir med ATLF-karakterer.'}, {'timestamp': (102.68, 107.72), 'text': ' Så bra. Jeg kan legge ut en kunngjøring om det etterpå også, kanskje.'}, {'timestamp': (107.8, 113.8), 'text': ' Så alle får det med seg. Jeg bare glemte det. Så kjempefint.'}, {'timestamp': (120.0, 126.84), 'text': ' Det kommer et par dokkeroppgaver.'}, {'timestamp': (126.92, 131.4), 'text': ' Det er litt endring på planen her.'}, {'timestamp': (131.4, 137.8), 'text': ' Vi syns det passer fint å starte med Windows PowerShell etter påske.'}, {'timestamp': (137.88, 143.8), 'text': ' Så blir det i hvert fall to runder med PowerShell digitalt.'}, {'timestamp': (143.88, 148.96), 'text': ' Så kommer det litt om dokker og DokkerHub denne uken.'}, {'timestamp': (150.0, 156.08), 'text': ' Det blir en sånn påskespesial med bare litt innhold.'}, {'timestamp': (156.08, 162.24), 'text': ' En kvarter-halvtime innhold, så ikke så veldig mye.'}, {'timestamp': (162.24, 167.4), 'text': ' Og oppgaver til dette vil da komme etter påske.'}, {'timestamp': (167.4, 175.16), 'text': ' Men uansett, jeg kan prøve å kanskje få lagt ut dette om Windows og Poshell'}, {'timestamp': (175.24, 179.98), 'text': ' og oppgaver, sånn at de som ønsker å ligge litt foran, vi kan jobbe.'}, {'timestamp': (180.0, 185.8), 'text': ' Og har lyst til å jobbe litt i påsken. De kan jobbe med jobb med det.'}, {'timestamp': (185.8, 193.84), 'text': ' Ok, andre spørsmål eller karakterer... Nei, eller karakterer! Kommentarer!'}, {'timestamp': (193.84, 198.48), 'text': ' Jeg har ikke fått noen hos meg, i hvert fall.'}, {'timestamp': (198.48, 204.88), 'text': ' Nei. Ok... Ja, oi... Og jeg hadde helt glemt å si'}, {'timestamp': (204.88, 209.96), 'text': ' at det er veldig hyggelig å se så mange av dere. Det er kjempebra.'}, {'timestamp': (210.0, 215.18), 'text': ' Vi har 75 stykker i chatten her nå.'}, {'timestamp': (215.18, 219.8), 'text': ' Veldig godt at dere står opp og jobber videre.'}, {'timestamp': (219.8, 225.68), 'text': ' Jeg skjønner at det kan være veldig tungt for mange av dere'}, {'timestamp': (225.68, 231.94), 'text': ' som sitter alene og jobber og ikke får besøke venner osv.'}, {'timestamp': (231.94, 235.54), 'text': ' Og ikke minst det jeg tror dere savner,'}, {'timestamp': (235.54, 239.96), 'text': ' er å kunne sitte sammen med andre studenter og samarbeide.'}, {'timestamp': (240.0, 245.76), 'text': ' Prøv gjerne, spesielt hvis dere jobber i gruppe, å få til litt jevnlig kontakt.'}, {'timestamp': (245.84, 253.36), 'text': ' Lag SOM-møter osv. Bruk screen når dere jobber med kommandolinje.'}, {'timestamp': (253.36, 260.6), 'text': ' Det er mulig å få til å samarbeide, også om dere sitter på hvert deres sett.'}, {'timestamp': (260.68, 267.84), 'text': ' Så prøv mest mulig å få til det.'}, {'timestamp': (270.02, 275.34), 'text': ' Hvor mange forsøk har vi på MC2? Dere har flere forsøk.'}, {'timestamp': (275.42, 283.98), 'text': ' I praksis så kan dere få... Ikke uvennlige forsøk, men dere kan få mange forsøk.'}, {'timestamp': (284.3, 287.94), 'text': ' Men... Og det er også derfor vi har lagt opp opplegget,'}, {'timestamp': (287.94, 292.34), 'text': ' sånn at man ikke bare kan få nye og nye forsøk hele tiden.'}, {'timestamp': (292.42, 296.14), 'text': ' For da er det mange som bare klikker i vei.'}, {'timestamp': (296.22, 299.78), 'text': ' Så tanken er at hvis du ikke får det til første gang,'}, {'timestamp': (300.02, 305.98), 'text': ' Så må du ta kontakt med en studentassistent, ikke minst... eller meg.'}, {'timestamp': (306.02, 311.42), 'text': ' Og så må du få diskutere... Finn ut hva det var du gjorde feil.'}, {'timestamp': (311.5, 316.22), 'text': ' Og kanskje hva må du jobbe litt mer med før du tar et nytt forsøk.'}, {'timestamp': (316.22, 322.9), 'text': ' Så jobb skikkelig med den responsen du får først, og så tar du et nytt forsøk.'}, {'timestamp': (323.22, 327.82), 'text': ' Men dette er ikke noen sånn straffedom. Det er først og fremst ment som et tilbud.'}, {'timestamp': (327.9, 329.98), 'text': ' Altså at dere skal få tilbakemeldinger på...'}, {'timestamp': (330.0, 335.12), 'text': ' Det er også viktig at MC2 er nok litt vanskeligere enn MC1.'}, {'timestamp': (335.12, 342.96), 'text': ' Og du kan også være litt uheldig. Det trekkes fra 30 spørsmål kanskje.'}, {'timestamp': (342.96, 347.16), 'text': ' Så du kan være litt uheldig og få noen som er spesielt vanskelig,'}, {'timestamp': (347.24, 351.08), 'text': ' som ikke er så lett å ta på ett minutt.'}, {'timestamp': (351.16, 359.0), 'text': ' Men fristen er, som det står her... Det blir vel litt vanskelig.'}, {'timestamp': (360.0, 364.78), 'text': ' 9. april, som er fristen for MC2.'}, {'timestamp': (364.78, 372.3), 'text': ' Så prøv absolutt å få gjort den denne uken, sånn at du får flere sjanser.'}, {'timestamp': (372.32, 375.92), 'text': ' Hvis dere ikke klarer den.'}, {'timestamp': (378.34, 389.0), 'text': ' Ok... Forrige gang så så vi på Plattformaget, aller først.'}, {'timestamp': (390.0, 395.84), 'text': ' Hva som skjedde når man flytter programmet rundt på plattformer.'}, {'timestamp': (396.02, 400.96), 'text': ' Hovedkonklusjonen er at programmer som er kopilert,'}, {'timestamp': (401.04, 405.64), 'text': ' sånn som C og C++, som kopieres til maskinkode,'}, {'timestamp': (405.72, 407.8), 'text': ' er helt plattformavhengig.'}, {'timestamp': (407.8, 416.24), 'text': ' Det betyr at de kan bare kjøre der på den plattformen de er kopilert.'}, {'timestamp': (416.44, 419.96), 'text': ' De fleste moderne språk, sånn som...'}, {'timestamp': (420.02, 428.42), 'text': ' Java og Python, CSharp også, de kjører virtuelle maskiner.'}, {'timestamp': (428.42, 434.58), 'text': ' Sånn at da komplerer man til en eller annen type bytekode.'}, {'timestamp': (434.58, 438.46), 'text': ' Og så kjøres det i en virtuell maskin.'}, {'timestamp': (438.54, 441.66), 'text': ' Det betyr at det er en virtuell maskin for hver plattform.'}, {'timestamp': (441.66, 446.74), 'text': ' Så da går det an i prinsippet å flytte kompliert kode fra en plattform til en annen.'}, {'timestamp': (446.74, 453.0), 'text': ' Men det kan ha litt avhengighet av versjoner, som vi så sist.'}, {'timestamp': (453.02, 458.5), 'text': ' Så begynte vi å se på tråder. Vi så litt teoretisk på tråder,'}, {'timestamp': (458.58, 463.02), 'text': ' men vi fikk ikke sett så veldig mye på det rent praktisk.'}, {'timestamp': (464.4, 469.34), 'text': ' Så vi skal ta en kjapp rekapitulering av Java-tråder,'}, {'timestamp': (469.34, 475.14), 'text': ' og så se på spesielt mange samtidige tråder. Så vi kan starte med det.'}, {'timestamp': (476.74, 479.82), 'text': ' Det var eksempelet.'}, {'timestamp': (506.74, 511.44), 'text': ' Trådprogram implementert i Java,'}, {'timestamp': (511.44, 517.1), 'text': ' som implementerer en rekke tråder...'}, {'timestamp': (517.12, 522.66), 'text': ' Jeg tror jeg kjører noe sånt som 20 tråder i det eksempelet her.'}, {'timestamp': (522.66, 526.5), 'text': ' Det var noen oppgaver i forrige uke som gikk ut på'}, {'timestamp': (526.58, 531.22), 'text': ' at man skulle se på hvor mange tråder som kjøres av operativsystemet'}, {'timestamp': (531.3, 536.7), 'text': ' når man kjører to tråder. Og da var det overraskende nok veldig mange tråder.'}, {'timestamp': (536.74, 540.34), 'text': ' Borti 20 tråder.'}, {'timestamp': (540.34, 547.14), 'text': ' Og det var en masse sånne workertreads som operativsystemet setter opp.'}, {'timestamp': (547.98, 553.42), 'text': ' Oi! Eller som JVM starter opp, og som operativsystemet skredulerer.'}, {'timestamp': (553.42, 559.72), 'text': ' Så det er hjelpetråder som står klare til å gjøre alle slags forskjellige oppgaver.'}, {'timestamp': (559.72, 565.74), 'text': ' Det koster ikke så mye å ha disse ekstra trådene, så derfor er det veldig mange programmer, sånn som Java...'}, {'timestamp': (566.76, 572.02), 'text': ' Chrome og andre applikasjoner som kjører en rekke tråder.'}, {'timestamp': (572.04, 577.52), 'text': ' Det koster ganske lite for operativseiere å ha de trådene kjørende'}, {'timestamp': (577.6, 581.0), 'text': ' når de ikke bruker CPU.'}, {'timestamp': (581.02, 586.04), 'text': ' Men her er da et eksempel på...'}, {'timestamp': (587.84, 591.04), 'text': ' Et eksempel som kjører med mange tråder.'}, {'timestamp': (591.08, 596.72), 'text': ' Så vi kan gå ned til klassen Calcmanny her, som er main.'}, {'timestamp': (596.74, 603.94), 'text': ' Og det som skjer her, er at vi definerer en intreds som er 20.'}, {'timestamp': (603.94, 608.44), 'text': ' Så det vi skal gjøre, er å starte 20 uavhengige tråder.'}, {'timestamp': (608.44, 615.12), 'text': ' Og her så kalles...'}, {'timestamp': (615.14, 619.02), 'text': ' Er opprettet et nytt trådobjekt, med new.'}, {'timestamp': (619.06, 623.1), 'text': ' Så her opprettes en ny tråd.'}, {'timestamp': (623.18, 623.1), 'text': ''}, {'timestamp': (627.9, 630.12), 'text': ' Og så skriver jeg bare ut at vi starter...'}, {'timestamp': (635.7, 639.26), 'text': ' At vi starter 20.30. Og så går jeg inn i forløkket.'}, {'timestamp': (644.3, 650.1), 'text': ' Ja, og her starter jeg da tråd nummer null. A new caltred. Og så når collegue 1, så starter jeg tråd nummer 1, osv.'}, {'timestamp': (650.18, 653.06), 'text': ' Så bare skriver jeg ut at jeg starter tråd nummer 1.'}, {'timestamp': (653.1, 657.94), 'text': ' Og så kaller jeg på startmetoden for tråden.'}, {'timestamp': (657.94, 663.06), 'text': ' Så dette skjer da 20 ganger. Og hvis vi går opp her, så ser vi'}, {'timestamp': (663.06, 670.22), 'text': ' hva som skjer når calc3d kalles.'}, {'timestamp': (671.54, 679.34), 'text': ' Da... Når calc3d startes opp, så kjøres denne in-hit-metoden her.'}, {'timestamp': (679.34, 687.0), 'text': ' Count pluss pluss... Da er det viktig å huske at...'}, {'timestamp': (687.02, 691.1), 'text': ' Count er definert som static.'}, {'timestamp': (691.2, 697.9), 'text': ' Og det betyr at det finnes bare én av den for alle trådene.'}, {'timestamp': (697.9, 702.42), 'text': ' Vi har 20 tråder, men bare én enkelt count-variabel.'}, {'timestamp': (702.86, 708.34), 'text': ' Mens en variabel som ikke blir deklarert som static, sånn som int id...'}, {'timestamp': (709.34, 713.5), 'text': ' Den har vi da 20 stykker av.'}, {'timestamp': (715.86, 720.02), 'text': ' Når vi har en maks her, så kunne også den vært static.'}, {'timestamp': (720.1, 726.1), 'text': ' For den skal være den samme for alle. Men her lager vi også 20 maks.'}, {'timestamp': (726.1, 728.9), 'text': ' Men det viktigste her er konto ID.'}, {'timestamp': (728.92, 734.7), 'text': ' Så hver gang vi øker konto, så økes den felles variabelen.'}, {'timestamp': (734.7, 740.9), 'text': ' Og dermed så teller den opp fra 1 og opp til 20.'}, {'timestamp': (742.58, 746.78), 'text': ' Og så setter ID en leak count, så da får vi en ID på hver.'}, {'timestamp': (746.86, 750.46), 'text': ' Og så sier jeg 3d nummer først 1 i starting...'}, {'timestamp': (750.54, 755.42), 'text': ' Så 3d nummer 1 Calculated Work.'}, {'timestamp': (756.18, 761.42), 'text': ' Og her ser vi at den tråden gjør et arbeid.'}, {'timestamp': (764.7, 768.58), 'text': ' Men det som skjer inneni work,'}, {'timestamp': (768.58, 775.9), 'text': ' er at 15 ganger så regner det ut en kjempelang løkke.'}, {'timestamp': (776.94, 782.46), 'text': ' Java er såpass rask at selv om man står og regner sånn som dette her,'}, {'timestamp': (782.72, 788.06), 'text': ' så kan man gjøre det... Hvor mange ganger kjører vi det her?'}, {'timestamp': (788.1, 793.1), 'text': ' 900 millioner ganger. Det er så mange ganger...'}, {'timestamp': (794.7, 799.54), 'text': ' Så blir det høyere enn en int. Så da får man trøbbel.'}, {'timestamp': (799.62, 803.98), 'text': ' Så dette er ekstremt mange ganger den går, men likevel så regner det mange ganger.'}, {'timestamp': (803.98, 807.9), 'text': ' Og det som er hovedpoenget her nå, med tråder, er at'}, {'timestamp': (807.9, 812.18), 'text': ' når vi setter i gang de, så kjører de samtidig.'}, {'timestamp': (812.18, 821.3), 'text': ' Så vi kan... Vi kan kompilere.'}, {'timestamp': (824.7, 830.48), 'text': ' Og så kjører vi her, kanskje.'}, {'timestamp': (830.48, 836.62), 'text': ' I sidevinduet, så vi kan se på trådene mens vi kjører.'}, {'timestamp': (836.64, 842.64), 'text': ' Jeg ser det starter veldig kjapt, så startes det opp 20 tråder.'}, {'timestamp': (842.66, 846.26), 'text': ' Så kan vi se på det i topp.'}, {'timestamp': (846.28, 853.9), 'text': ' I utgangspunktet så ser vi at det er én prosess som kjører.'}, {'timestamp': (854.7, 859.54), 'text': ' Men hvis vi legger på...'}, {'timestamp': (862.66, 867.02), 'text': " Hvis vi velger ut 'number of threads',"}, {'timestamp': (867.02, 872.34), 'text': ' så ser vi at den ene prosessen som kjører, den har 37 tråder.'}, {'timestamp': (872.34, 880.58), 'text': ' Vi ser også at faktisk de fleste andre prosesser også har en rekke tråder.'}, {'timestamp': (881.3, 884.1), 'text': ' Sånn som Zoom har 64 tråder. Ops, har 27.'}, {'timestamp': (884.72, 888.2), 'text': ' Men det som er spesielt med våre tråder nå,'}, {'timestamp': (888.28, 893.02), 'text': ' er at 20 av de er de regnetrådene som vi har startet.'}, {'timestamp': (893.02, 900.36), 'text': ' Så kan vi også, hvis vi taster H, så får vi se alle trådene.'}, {'timestamp': (900.36, 906.36), 'text': ' Og da ser vi at det er 20 tråder som står og kjører.'}, {'timestamp': (906.36, 913.36), 'text': ' Så kunne vi også ta og se på Last Use CPU. Hvis jeg velger den...'}, {'timestamp': (914.7, 923.06), 'text': ' Så ser vi da at trådene er skredulert på forskjellige CPU-er.'}, {'timestamp': (923.06, 929.94), 'text': ' Noen er da så klart på mange, for her er det bare 0 til 7 av CPU-er.'}, {'timestamp': (929.94, 937.46), 'text': ' Men vi ser da hvordan det er operativsystemet som skredulerer alle trådene.'}, {'timestamp': (937.46, 943.7), 'text': ' Java bare setter i gang en masse tråder, og så blir det skredulert av OS.'}, {'timestamp': (944.72, 949.68), 'text': ' Og akkurat det samme er det med alle de andre programmene.'}, {'timestamp': (949.68, 951.92), 'text': ' De starter en rekke tråder,'}, {'timestamp': (952.0, 960.96), 'text': ' men de blir skredulert som helt uavhengige enheter.'}, {'timestamp': (961.8, 964.8), 'text': ' Ok...'}, {'timestamp': (974.7, 980.94), 'text': ' Da skal vi se på et annet eksempel.'}, {'timestamp': (981.94, 987.74), 'text': ' Og prioritet i Java er...'}, {'timestamp': (988.58, 995.54), 'text': ' Det vi skal se, er at prioritet er litt merkelig implementert,'}, {'timestamp': (995.62, 998.58), 'text': ' på en måte, i Java.'}, {'timestamp': (998.66, 1003.46), 'text': ' Det er implementert forskjellig i Linux og i Windows, f.eks.'}, {'timestamp': (1004.7, 1012.28), 'text': ' Men i dette eksempelet skal vi se at det faktisk ikke er det.'}, {'timestamp': (1012.28, 1018.4), 'text': ' Men før vi diskuterer det, så kan vi se på...'}, {'timestamp': (1020.1, 1026.9), 'text': ' Skal vi se... Jeg har et Java-program som heter Prior.java.'}, {'timestamp': (1028.72, 1033.68), 'text': ' Dette programmet implementerer da prioritet.'}, {'timestamp': (1034.7, 1041.24), 'text': ' Det ligner ganske på de andre programmene vi har sett på.'}, {'timestamp': (1043.46, 1049.18), 'text': ' I dette tilfellet så startes det to tråder.'}, {'timestamp': (1049.18, 1056.1), 'text': ' Prioritredd én som jeg kaller S1, og én som jeg kaller S2.'}, {'timestamp': (1056.1, 1061.78), 'text': ' Jeg kaller det prioritredd fordi jeg bruker prioritering.'}, {'timestamp': (1064.7, 1070.34), 'text': ' Og så setter jeg prioriteten til S1 til 5.'}, {'timestamp': (1070.34, 1074.78), 'text': ' Det er faktisk default-prioritet,'}, {'timestamp': (1074.86, 1080.58), 'text': ' så hvis jeg ikke hadde gjort det, så ville den likevel vært 5.'}, {'timestamp': (1080.86, 1083.94), 'text': ' Og så er det noen variabler.'}, {'timestamp': (1084.02, 1086.74), 'text': ' SN Norm Priority. Jeg skriver ut den'}, {'timestamp': (1086.74, 1092.02), 'text': ' for å få frem hva som er normal prioritet, eller standard.'}, {'timestamp': (1092.16, 1094.44), 'text': ' Og så skriver jeg ut maks prioritet og min prioritet.'}, {'timestamp': (1094.7, 1102.5), 'text': ' Maksprioritet er ti, hvis jeg husker riktig, og min er én.'}, {'timestamp': (1103.54, 1107.62), 'text': ' Så dette er motsatt av nice, for nice er jo hvor snill man er med andre.'}, {'timestamp': (1107.62, 1111.14), 'text': ' Så det er ti prioritetsklasser.'}, {'timestamp': (1111.14, 1118.5), 'text': ' Ja, min er null. Vi starter på null, og så er maks ti. Så...'}, {'timestamp': (1120.86, 1124.5), 'text': ' Nei... Sorry, glem det jeg sa.'}, {'timestamp': (1124.7, 1127.96), 'text': ' Dette er ikke prioriteten.'}, {'timestamp': (1127.96, 1132.6), 'text': ' Det som jeg sender med der, er antall millisekunder'}, {'timestamp': (1132.68, 1136.08), 'text': ' som tråden skal sove før den starter.'}, {'timestamp': (1136.08, 1139.32), 'text': ' Vi ser begge starter med en gang.'}, {'timestamp': (1139.34, 1143.62), 'text': ' Men jeg setter prioriteten for tråd nummer to. Den setter jeg til 10.'}, {'timestamp': (1143.62, 1149.08), 'text': ' Så vi starter én tråd med prioritet 5 og én med prioritet 10.'}, {'timestamp': (1149.1, 1154.62), 'text': ' 10 er det aller høyeste, så da burde man forvente at et eller annet...'}, {'timestamp': (1154.7, 1158.86), 'text': ' Det skjer sånn at tråd nummer to kjører mer.'}, {'timestamp': (1158.86, 1163.7), 'text': ' Vi har jo bedt om at den skal få høyere prioritet.'}, {'timestamp': (1163.7, 1167.12), 'text': ' Vi kan se kjapt øverst her hva vi gjør.'}, {'timestamp': (1167.14, 1172.26), 'text': ' Det vi gjør, ligner veldig på det vi gjorde tidligere.'}, {'timestamp': (1172.34, 1176.18), 'text': ' Vi har en tellecount og en ID, så de får ID 1 og 2.'}, {'timestamp': (1176.18, 1180.22), 'text': ' Og så i tillegg så er det millisekunder.'}, {'timestamp': (1180.3, 1184.68), 'text': ' Det skal vi bruke på Windows etterpå når vi skal kjøre det der.'}, {'timestamp': (1184.7, 1189.16), 'text': ' Gi tråden noen millisekunder før den starter.'}, {'timestamp': (1189.16, 1192.14), 'text': ' Men vi gir den null millisekunder her,'}, {'timestamp': (1192.22, 1196.46), 'text': ' sånn at det er lettere å se hva som skjer i vårt tilfelle.'}, {'timestamp': (1196.48, 1203.78), 'text': ' Så vi kan jo også se hvordan vi behandler to forskjellige tråder.'}, {'timestamp': (1203.78, 1210.54), 'text': ' For de kjører i utgangspunktet samme kode, men så ser vi...'}, {'timestamp': (1210.54, 1216.18), 'text': ' Her er Rønn-metoden, som sier tråd nummer én sover først,'}, {'timestamp': (1216.18, 1220.54), 'text': ' null millisekunder, og så starter den. Men så ser vi...'}, {'timestamp': (1220.54, 1227.74), 'text': ' Her har jeg en if-test hvor jeg da tester hvis Ida er lik to,'}, {'timestamp': (1227.74, 1232.58), 'text': ' så setter jeg prioritet til én. Så på den måten kan man da'}, {'timestamp': (1232.58, 1235.98), 'text': ' behandle tråder og gjøre forskjellige ting,'}, {'timestamp': (1236.06, 1240.5), 'text': ' selv om trådene i utgangspunktet er like. Så vi kan se...'}, {'timestamp': (1240.54, 1250.54), 'text': ' Hvordan dette ser ut når vi kompilerer og...'}, {'timestamp': (1252.42, 1257.94), 'text': '... kjører denne tråden. Så da ser vi.'}, {'timestamp': (1257.96, 1261.46), 'text': ' Vi starter default prioritet fem.'}, {'timestamp': (1261.48, 1264.3), 'text': ' Vi starter nummer én med prioritet fem.'}, {'timestamp': (1264.3, 1270.34), 'text': ' Og så starter nummer to med prioritet... ti.'}, {'timestamp': (1270.54, 1277.56), 'text': ' De kjører annenhver gang. Det går akkurat like fort med nr. 1 som med nr. 2.'}, {'timestamp': (1277.56, 1282.96), 'text': ' Så går vi ned her og setter prioriteten for tråd nr. 2.'}, {'timestamp': (1283.16, 1287.86), 'text': ' Den setter vi til 1, så da burde den ha minst prioritet.'}, {'timestamp': (1287.94, 1291.7), 'text': ' 1 er da det minste. Men likevel så ser vi'}, {'timestamp': (1291.7, 1297.78), 'text': ' at disse to jobber akkurat like fort.'}, {'timestamp': (1300.54, 1307.74), 'text': ' Hvis vi prøver å se på topp når de jobber, så...'}, {'timestamp': (1307.74, 1312.14), 'text': ' Så får begge 100 % CPU.'}, {'timestamp': (1312.18, 1316.46), 'text': ' Vi har ikke noe nice eller noe sånt der.'}, {'timestamp': (1320.46, 1327.26), 'text': ' Men vi har jo også sett tidligere at hvis man har nice-prosesser, så...'}, {'timestamp': (1327.34, 1330.14), 'text': ' Så vil de ikke være nice i forhold til hverandre.'}, {'timestamp': (1330.54, 1337.6), 'text': ' Det jeg kunne prøve å gjøre, var å starte trådene med TaskSet.'}, {'timestamp': (1337.6, 1345.06), 'text': ' Det har jeg faktisk ikke tenkt på tidligere, men vi kan gjøre et forsøk.'}, {'timestamp': (1345.06, 1351.34), 'text': ' Hvis jeg nå ser på Last Use TPU...'}, {'timestamp': (1351.34, 1360.38), 'text': ' Og så kan jeg prøve å starte Java med TaskSet minus 1.0.'}, {'timestamp': (1360.54, 1367.54), 'text': ' Sånn.'}, {'timestamp': (1368.94, 1377.58), 'text': ' Og så H. Da ser vi begge trådene kjører på tråd 0.'}, {'timestamp': (1377.58, 1383.98), 'text': ' Men vi ser at de deler helt broderlig.'}, {'timestamp': (1383.98, 1388.98), 'text': ' Selv om den ene tråden nå har prioritet 5.'}, {'timestamp': (1390.54, 1396.54), 'text': ' Og den andre har prioritert 10.'}, {'timestamp': (1396.6, 1400.9), 'text': ' Så tråd nr. 2 har prioritert 10, men dette gir ikke utslag på'}, {'timestamp': (1400.98, 1403.3), 'text': ' hvor mye CPU de får.'}, {'timestamp': (1403.3, 1409.74), 'text': ' Og vi kan ikke annet enn konkludere med at Linux faktisk ikke bryr seg'}, {'timestamp': (1409.82, 1416.24), 'text': ' om den prioriteten. Om du setter prioritet 1 eller 10, spiller ingen rolle.'}, {'timestamp': (1416.24, 1419.98), 'text': ' Men vi overlater til oppgavene.'}, {'timestamp': (1420.54, 1426.72), 'text': ' I oppgavene denne uken så blir dere bedt om å...'}, {'timestamp': (1426.72, 1432.96), 'text': ' Prøve å få Linux til å ta hensyn til Java-prioriteten.'}, {'timestamp': (1433.08, 1439.4), 'text': ' Og det er mulig hvis du kjører Java på en spesiell måte med et spesielt flagg.'}, {'timestamp': (1439.88, 1443.84), 'text': ' Men det virker ikke da hvis du kjører som vanlig bruker.'}, {'timestamp': (1443.96, 1449.24), 'text': ' Du må faktisk kjøre som Ruth, og i tillegg må du ha et spesielt flagg.'}, {'timestamp': (1450.54, 1454.94), 'text': ' Implementerer JVM dette her med NICE?'}, {'timestamp': (1455.02, 1460.86), 'text': ' At man setter NICE på Java-trådene,'}, {'timestamp': (1460.98, 1464.7), 'text': ' sånn at de har prioritet i forhold til hverandre.'}, {'timestamp': (1464.7, 1470.38), 'text': ' For å se dette eksplisitt, så må du gjøre sånn som jeg gjorde nå,'}, {'timestamp': (1470.46, 1475.0), 'text': ' og bruke tastet ditt, sånn at de eksplisitt kjører på samme CPU.'}, {'timestamp': (1475.02, 1479.66), 'text': ' Hvis ikke, så ser du ikke effekten, med mindre du har veldig mange...'}, {'timestamp': (1480.54, 1485.86), 'text': ' Har veldig mange tråder. Flere tråder enn Sepur.'}, {'timestamp': (1487.12, 1490.54), 'text': ' Ok. Da tenkte jeg å...'}, {'timestamp': (1492.34, 1498.34), 'text': ' Ja, jeg tenkte egentlig også å kjøre trådene på...'}, {'timestamp': (1500.14, 1503.22), 'text': ' Kjøre trådene på Windows.'}, {'timestamp': (1503.22, 1510.14), 'text': ' Men skal vi se... Ja, det tar litt tid å sette opp de Windows-trådene.'}, {'timestamp': (1510.54, 1517.88), 'text': ' Hvis vi gjør det etter pausen, så kan vi heller se på...'}, {'timestamp': (1517.88, 1522.82), 'text': ' Nå gå til litt flere slides om tråder.'}, {'timestamp': (1522.98, 1525.74), 'text': ' Så vi skal se litt mer teoretisk på tråder.'}, {'timestamp': (1525.74, 1529.74), 'text': ' Og aller først skal vi se på blokkerende systemkall.'}, {'timestamp': (1529.84, 1534.3), 'text': ' Men før vi avslutter demoen her...'}, {'timestamp': (1534.3, 1539.5), 'text': ' Vi skal se etter pause at hvis vi gjør dette samme på Windows...'}, {'timestamp': (1540.54, 1546.62), 'text': ' kjører det samme programmet,'}, {'timestamp': (1546.76, 1552.22), 'text': ' så vil vi se at Windows faktisk tar hensyn til prioriteten.'}, {'timestamp': (1552.3, 1557.34), 'text': ' Og den tar kraftig hensyn. Så hvis du er i tråd med prioritet 4,'}, {'timestamp': (1557.42, 1563.62), 'text': ' så får den mye lavere prioritet enn en tråd med prioritet 5.'}, {'timestamp': (1563.62, 1568.42), 'text': ' Mens Linux da ikke tar hensyn i det hele tatt.'}, {'timestamp': (1570.54, 1574.24), 'text': ' Ok...'}, {'timestamp': (1600.54, 1604.22), 'text': ' At man ønsker å lese noe fra en disk.'}, {'timestamp': (1604.54, 1610.46), 'text': ' Og da er det jo naturlig at programmet ikke går videre'}, {'timestamp': (1610.54, 1614.18), 'text': ' før den har lest det som den har på disken.'}, {'timestamp': (1614.26, 1618.62), 'text': ' Og i alle denne type systemkall hvor man må vente på resultatet'}, {'timestamp': (1618.7, 1621.02), 'text': ' før programmet kan gå videre,'}, {'timestamp': (1621.04, 1626.26), 'text': ' det er da representert ved et blokkerende systemkall.'}, {'timestamp': (1626.34, 1630.14), 'text': ' For da gjør man et systemkall, og så blokkerer det prosessen.'}, {'timestamp': (1630.54, 1637.7), 'text': ' Og det kan være veldig uheldig.'}, {'timestamp': (1637.7, 1642.98), 'text': ' For du ønsker gjerne at en applikasjon skal være responsiv,'}, {'timestamp': (1643.06, 1648.66), 'text': ' selv om den leser noe fra disk eller gjør noe annet som krever IO.'}, {'timestamp': (1648.66, 1657.26), 'text': ' Og derfor så... Det var på en måte en av hovedideene for å få inn tråder.'}, {'timestamp': (1657.68, 1659.48), 'text': ' Nemlig at programmereren kan da... Ved hjelp av IO...'}, {'timestamp': (1660.54, 1668.46), 'text': ' Programmet trenger da ikke å vente på blokkerende systemkall.'}, {'timestamp': (1668.46, 1674.34), 'text': ' Noen eksempler på den type systemkall er sånn som read and write,'}, {'timestamp': (1674.34, 1678.58), 'text': ' await og opplagt når du venter på andre til to år,'}, {'timestamp': (1678.6, 1684.48), 'text': ' og sleep er også opplagt blokkerende, for der venter du eksplisitt.'}, {'timestamp': (1684.48, 1689.44), 'text': ' Det mest typiske er sånn som read, hvor du leser noe fra disk,'}, {'timestamp': (1690.54, 1695.84), 'text': ' Og vente på å få resultatet før du kan kjøre videre.'}, {'timestamp': (1695.84, 1700.54), 'text': ' Så fins en del ikke-blokkerende systemkall også, eller veldig mange,'}, {'timestamp': (1700.62, 1704.38), 'text': ' sånn som GetPayDay og GetTimeOfDay f.eks.'}, {'timestamp': (1704.38, 1712.34), 'text': ' De eksekverer ferdig veldig raskt, og de blokkerer da ikke prosessen.'}, {'timestamp': (1716.7, 1719.34), 'text': ' Trådmodeller.'}, {'timestamp': (1720.54, 1724.66), 'text': ' Det finnes mange implementasjoner av tråder,'}, {'timestamp': (1724.74, 1730.94), 'text': ' og dette er de tre vanligste og mest brukte trådmodellene.'}, {'timestamp': (1730.94, 1736.54), 'text': ' Og den som er aller vanligst med en gang, det er én til én.'}, {'timestamp': (1736.62, 1742.18), 'text': ' Det er denne modellen her, hvor for hver tråd brukeren starter,'}, {'timestamp': (1742.18, 1748.1), 'text': ' f.eks. vi starter et Java-program, JVM starter 20 tråder...'}, {'timestamp': (1750.54, 1753.32), 'text': ' Tilsvarende være 20 kjernetråder.'}, {'timestamp': (1753.34, 1756.54), 'text': ' Det betyr i praksis at du har 20 tråder'}, {'timestamp': (1756.62, 1761.06), 'text': ' som skreduleres som 20 uavhengige enheter.'}, {'timestamp': (1761.06, 1764.66), 'text': ' 20 uavhengige regneoperasjoner.'}, {'timestamp': (1767.14, 1770.74), 'text': ' I tillegg så har vi én til mange.'}, {'timestamp': (1770.8, 1777.28), 'text': ' Vi kan se litt på neste slide hvor disse blir beskrevet.'}, {'timestamp': (1777.3, 1779.3), 'text': ' Én til mange, det...'}, {'timestamp': (1780.54, 1783.72), 'text': ' Betyr at alle trådene skeduleres som én prosess.'}, {'timestamp': (1783.8, 1786.84), 'text': ' Det er ikke så veldig vanlig lenger.'}, {'timestamp': (1786.96, 1790.12), 'text': ' Tidligere fantes en del sånne implementasjoner.'}, {'timestamp': (1790.24, 1792.96), 'text': ' Det kalles ofte green threats.'}, {'timestamp': (1793.08, 1796.74), 'text': ' Den aller første implementasjonen på Linux av JVM var til green threats.'}, {'timestamp': (1796.74, 1799.78), 'text': ' Men det er jo litt upraktisk,'}, {'timestamp': (1799.88, 1804.08), 'text': ' for det som skjer da, er at programmeren selv må skedulere.'}, {'timestamp': (1804.08, 1808.76), 'text': ' Vi har f.eks. en metode som kalles yield, som sier OK, nå vil jeg gi fra meg SFP-en.'}, {'timestamp': (1810.54, 1813.04), 'text': ' Og GIL er en sånn...'}, {'timestamp': (1813.06, 1820.42), 'text': ' Er ikke så mye i bruk når man overlater til operativsystemet å skredulere.'}, {'timestamp': (1820.42, 1824.42), 'text': ' Men dette er da den trådmodellen.'}, {'timestamp': (1824.42, 1826.98), 'text': ' Så har vi 1-1, som er den mest vanlige,'}, {'timestamp': (1827.02, 1833.06), 'text': ' hvor alle tråder skreduleres uavhengig av hverandre av operativsystemet.'}, {'timestamp': (1833.06, 1840.46), 'text': ' Det er det som vi har i Java, og etter pausen skal vi se på noe Post-X-Treads.'}, {'timestamp': (1840.54, 1844.1), 'text': ' De skreduleres også på denne måten.'}, {'timestamp': (1844.1, 1849.48), 'text': ' Så har man en tredje måte, mange-til-mange.'}, {'timestamp': (1849.48, 1855.5), 'text': ' Og da skreduleres de som én-til-én, hvis det ikke er altfor mange tråder.'}, {'timestamp': (1855.5, 1859.1), 'text': ' Men så har det vært en del operativsystemer'}, {'timestamp': (1859.1, 1862.62), 'text': ' som har man implementert mange-til-mange'}, {'timestamp': (1862.62, 1866.5), 'text': ' for tilfeller hvor det er ekstremt mange tråder.'}, {'timestamp': (1866.58, 1868.94), 'text': ' Altså mange hundre eller mange tusen tråder.'}, {'timestamp': (1870.54, 1875.4), 'text': ' Kan det være uheldig at alle disse trådene'}, {'timestamp': (1875.4, 1881.22), 'text': ' skreduleres hver for seg? Så lager man grupper,'}, {'timestamp': (1881.26, 1887.94), 'text': ' sånn at én kjernetråd tar hånd om et sett av tråder.'}, {'timestamp': (1887.94, 1892.3), 'text': ' Når det er snakk om mange, kan det være 50 tråder'}, {'timestamp': (1892.38, 1897.5), 'text': ' som skreduleres av denne, og 50 av denne tråden.'}, {'timestamp': (1897.52, 1903.32), 'text': ' Da får de en intern skredulering seg imellom.'}, {'timestamp': (1909.64, 1912.36), 'text': ' Synkronisering.'}, {'timestamp': (1913.6, 1917.48), 'text': ' Ja, da er vi over på et helt nytt tema,'}, {'timestamp': (1917.56, 1920.72), 'text': ' men som ligger tett opp til dette med tråder'}, {'timestamp': (1920.72, 1926.96), 'text': ' og problemer man kan få når man kjører tråder samtidig.'}, {'timestamp': (1927.5, 1931.34), 'text': ' Kommunikasjon og kommunikasjon er generelt viktig'}, {'timestamp': (1931.34, 1935.78), 'text': ' når man har felles ressurser eller felles data'}, {'timestamp': (1935.78, 1940.58), 'text': ' som flere prosesser samtidig behandler.'}, {'timestamp': (1940.58, 1945.3), 'text': ' Og dette kommer til å være tema resten av dagen.'}, {'timestamp': (1945.3, 1950.18), 'text': ' Vi skal se på noen konkrete eksempler på hva som kan gå galt'}, {'timestamp': (1950.2, 1956.5), 'text': ' hvis prosesser prøver å endre på felles data samtidig. Da kan det bli en skikkelig krasj.'}, {'timestamp': (1957.5, 1967.92), 'text': ' Og de prinsippene vi følger, er at prosesser må ikke endre felles data samtidig.'}, {'timestamp': (1968.02, 1972.48), 'text': ' Vi har et eksempel med et billettsystem.'}, {'timestamp': (1973.06, 1980.7), 'text': ' Og hvis den ene prosessen da tar en billett og oppdaterer...'}, {'timestamp': (1980.78, 1986.26), 'text': ' Og deler ut den billetten samtidig som en annen gjør det samme...'}, {'timestamp': (1987.5, 1991.62), 'text': ' Da kan vi få problemer. Det er en såkalt race condition.'}, {'timestamp': (1991.62, 1995.94), 'text': ' Det har noe å si hvem som kommer først frem.'}, {'timestamp': (1995.94, 2001.94), 'text': ' Databasen kan ødelegges. Den variabelen kan få en feil verdi'}, {'timestamp': (2002.02, 2007.22), 'text': ' hvis man ikke synkroniserer. Det er derfor synkronisering er så viktig.'}, {'timestamp': (2007.3, 2012.46), 'text': ' Og dette er altså noe som praktisk dukker opp med en gang man har'}, {'timestamp': (2012.46, 2017.42), 'text': ' prosesser som jobber mot noe felles. Og det er veldig vanlig.'}, {'timestamp': (2017.5, 2021.18), 'text': ' Nå som man har masse distribuerte systemer'}, {'timestamp': (2021.18, 2024.98), 'text': ' som kobler seg opp mot samme database,'}, {'timestamp': (2025.06, 2033.54), 'text': ' så er det veldig viktig å synkronisere disse tilgangene til data.'}, {'timestamp': (2033.54, 2042.94), 'text': ' Et andre prinsipp vi har, er at en prosess ikke bør lese fellesdata'}, {'timestamp': (2043.02, 2046.26), 'text': ' mens en annen endrer dem.'}, {'timestamp': (2047.5, 2052.98), 'text': ' Den må også kunne vente på resultater fra en annen prosess.'}, {'timestamp': (2052.98, 2057.86), 'text': ' Det er en annen måte å synkronisere på, som vi skal se på senere.'}, {'timestamp': (2057.86, 2062.18), 'text': ' Da må prosessene seg imellom synkroniseres.'}, {'timestamp': (2064.98, 2072.1), 'text': ' Serialisering er det temaet vi først og fremst skal se på i dag.'}, {'timestamp': (2072.1, 2077.46), 'text': ' Da ser vi på prosesser eller tråder som aksesserer felles data.'}, {'timestamp': (2077.5, 2082.64), 'text': ' Det kan være bare én enkelt variabel.'}, {'timestamp': (2082.66, 2085.38), 'text': ' Men det som er viktig, er at de har felles.'}, {'timestamp': (2085.38, 2089.5), 'text': ' Med jawatråder vil det være en static...'}, {'timestamp': (2089.5, 2093.94), 'text': ' Når vi definerer en variabel som static, så er den felles.'}, {'timestamp': (2093.94, 2097.4), 'text': ' Vi skal se noen eksempler med at dette er en saldo.'}, {'timestamp': (2097.4, 2101.2), 'text': ' Det er opplagt at når man gjør endringer på saldo,'}, {'timestamp': (2101.92, 2103.52), 'text': ' så må det gjøres systematisk.'}, {'timestamp': (2103.54, 2107.26), 'text': ' Og da må én av gangen jobbe på de dataene.'}, {'timestamp': (2107.5, 2113.14), 'text': ' Problemet er typisk at man leser av en saldo.'}, {'timestamp': (2113.5, 2118.82), 'text': ' Det kan være fra en database, men det kan også være fra en felles variable ramm.'}, {'timestamp': (2118.84, 2122.86), 'text': ' Men som vi har sett tidligere, når SEP 1 skal regne på det,'}, {'timestamp': (2122.86, 2127.52), 'text': ' så vil den verdien lastes inn i registrene.'}, {'timestamp': (2127.52, 2133.62), 'text': ' Og der kan det fort bli krøll hvis to prosesser ikke er synkronisert,'}, {'timestamp': (2133.62, 2137.06), 'text': ' eller serialisert, når de gjør dette.'}, {'timestamp': (2137.5, 2142.6), 'text': ' Det vi selv realiserer, er at vi sier at én av gangen får tilgang til denne fellesvarerabelen.'}, {'timestamp': (2142.6, 2147.7), 'text': " Hele denne problemsiden kalles 'of the race condition',"}, {'timestamp': (2147.7, 2151.72), 'text': ' altså konkurranse om en felles ressurs.'}, {'timestamp': (2151.72, 2157.44), 'text': ' Den race condition vil da være sånn at utfallet av å kjøre programmene'}, {'timestamp': (2157.54, 2162.8), 'text': ' er forskjellig avhengig av hvilken prosess som kommer først fram til den felles ressursen.'}, {'timestamp': (2162.82, 2167.46), 'text': ' Og sånn kan det absolutt ikke være. Alt programmet bør være sånn at...'}, {'timestamp': (2167.5, 2171.9), 'text': ' Hvis du kjører de med akkurat samme randbetingelser,'}, {'timestamp': (2171.98, 2175.2), 'text': ' akkurat samme forutsetninger, så bør resultatet bli det samme.'}, {'timestamp': (2175.2, 2178.7), 'text': ' Men det skal vi se. Hvis man ikke serialiserer,'}, {'timestamp': (2179.0, 2183.18), 'text': ' så skal vi se flere eksempler på at da går det virkelig galt,'}, {'timestamp': (2183.26, 2185.38), 'text': ' og data ødelegges.'}, {'timestamp': (2185.38, 2189.26), 'text': ' Så er det også et viktig poeng at det er programmereren selv'}, {'timestamp': (2189.34, 2191.98), 'text': ' som må serialisere prosesser.'}, {'timestamp': (2191.98, 2196.02), 'text': ' Men som vi skal se, operativsystemet legger til rette for det.'}, {'timestamp': (2197.5, 2204.42), 'text': ' Muligheter som programmereren har for å selvrealisere.'}, {'timestamp': (2209.02, 2215.3), 'text': ' Ja, men da tar vi en pause der. Men jeg skal bare først ta...'}, {'timestamp': (2215.38, 2221.38), 'text': ' Det var et interessant spørsmål i chatten her.'}, {'timestamp': (2227.5, 2233.42), 'text': ' Hvis det ikke har så mye å si hvordan prosessene kjøres...'}, {'timestamp': (2233.46, 2239.46), 'text': ' Jeg antar tanken her da... Sånn som Java.'}, {'timestamp': (2239.46, 2244.94), 'text': ' Java på Linux, hvis den ikke tar hensyn til prioriteten...'}, {'timestamp': (2245.02, 2251.18), 'text': ' Vel, det... Vanligvis så har alle tråder samme prioritet.'}, {'timestamp': (2251.26, 2257.42), 'text': ' Og det fungerer i de aller fleste tilfeller helt greit. Fordi operativsystemet er så bra.'}, {'timestamp': (2257.5, 2265.9), 'text': ' De fordeler ressurser, og operativstemme er veldig bra til å gi respons'}, {'timestamp': (2265.9, 2271.74), 'text': ' til prosesser som ønskerespons fra et tastetrykk f.eks.'}, {'timestamp': (2272.38, 2275.3), 'text': ' Så får den lynraskt den responsen.'}, {'timestamp': (2275.3, 2281.66), 'text': ' Hovedgrunnen til at man ikke har tatt så nøye på implementering av prioritet,'}, {'timestamp': (2281.74, 2286.46), 'text': ' som i Java, er at operativstemme gjør den jobben veldig bra.'}, {'timestamp': (2287.5, 2295.7), 'text': ' Likevel mange fordeler. En av de største er at prosessen slipper å vente.'}, {'timestamp': (2295.7, 2299.74), 'text': ' Du kan ha en tråd som står og venter på input og oppputt,'}, {'timestamp': (2299.82, 2303.08), 'text': ' og ikke minst så kan du utnytte flere CPU-er.'}, {'timestamp': (2303.08, 2308.02), 'text': ' Hvis du har en server med 48 CPU-er, så er det helt strålende å kunne'}, {'timestamp': (2308.1, 2315.38), 'text': ' sette i gang 48 tråder som jobber i parallell på dem og utnytter ressursene.'}, {'timestamp': (2317.5, 2323.74), 'text': ' Ja, OK. Men da tar vi en pause der.'}, {'timestamp': (2323.74, 2328.02), 'text': ' Og så tar vi et kvarters pause til... hva blir det?'}, {'timestamp': (2328.14, 2333.14), 'text': ' 9.35 kan vi ta en pause.'}]}